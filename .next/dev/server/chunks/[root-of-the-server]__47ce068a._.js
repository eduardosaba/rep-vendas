module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[project]/src/lib/supabaseClient.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "supabase",
    ()=>supabase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$81$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/@supabase+supabase-js@2.81.1/node_modules/@supabase/supabase-js/dist/module/index.js [app-route] (ecmascript) <locals>");
;
const supabaseUrl = ("TURBOPACK compile-time value", "https://aawghxjbipcqefmikwby.supabase.co") || 'YOUR_SUPABASE_URL';
const supabaseAnonKey = ("TURBOPACK compile-time value", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFhd2doeGpiaXBjcWVmbWlrd2J5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5NjI3NTgsImV4cCI6MjA3ODUzODc1OH0.Ml1sIc2rpkXAh-DuILaNKwFRmI6-COOeZY-HoBILJUw") || 'YOUR_SUPABASE_ANON_KEY';
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$81$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey);
}),
"[project]/src/app/api/send-email/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.2_@babel+core@7.2_ac612d167d9caedc69b237559ab43d82/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/supabaseClient.ts [app-route] (ecmascript)");
;
;
async function POST(request) {
    try {
        const { to, subject, html, text, userId } = await request.json();
        // Valida√ß√£o b√°sica
        if (!to || !subject || !html && !text) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Campos obrigat√≥rios: to, subject, html ou text'
            }, {
                status: 400
            });
        }
        // Buscar configura√ß√µes de email do usu√°rio
        let settings = null;
        if (userId) {
            const { data } = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('settings').select('email_provider, email_api_key, email_from').eq('user_id', userId).single();
            settings = data;
        }
        // Se n√£o encontrou configura√ß√µes, usar valores padr√£o ou simular
        const emailProvider = settings?.email_provider || 'resend';
        const apiKey = settings?.email_api_key;
        const fromEmail = settings?.email_from || 'noreply@repvendas.com';
        // Se n√£o h√° chave API configurada, simular envio
        if (!apiKey) {
            console.log('üìß Email simulado (sem chave API configurada):', {
                from: fromEmail,
                to,
                subject,
                html: html?.substring(0, 100) + '...',
                text: text?.substring(0, 100) + '...',
                provider: emailProvider,
                timestamp: new Date().toISOString()
            });
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                success: true,
                message: 'Email enviado com sucesso (simulado - configure chave API para envio real)',
                messageId: `sim_${Date.now()}`
            });
        }
        // Integra√ß√£o real com provedores de email
        let result;
        switch(emailProvider){
            case 'resend':
                result = await sendWithResend(apiKey, fromEmail, to, subject, html, text);
                break;
            case 'sendgrid':
                result = await sendWithSendGrid(apiKey, fromEmail, to, subject, html, text);
                break;
            case 'mailgun':
                result = await sendWithMailgun(apiKey, fromEmail, to, subject, html, text);
                break;
            default:
                // Fallback para simula√ß√£o
                console.log('üìß Email enviado (provedor n√£o suportado):', {
                    provider: emailProvider,
                    from: fromEmail,
                    to,
                    subject,
                    timestamp: new Date().toISOString()
                });
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                    success: true,
                    message: `Email enviado via ${emailProvider} (simulado)`,
                    messageId: `prov_${Date.now()}`
                });
        }
        if (result.success) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                success: true,
                message: 'Email enviado com sucesso',
                messageId: result.messageId
            });
        } else {
            throw new Error(result.error);
        }
    } catch (error) {
        console.error('Erro ao enviar email:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$2_$40$babel$2b$core$40$7$2e$2_ac612d167d9caedc69b237559ab43d82$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'Erro interno do servidor'
        }, {
            status: 500
        });
    }
}
// Fun√ß√£o para envio via Resend
async function sendWithResend(apiKey, from, to, subject, html, text) {
    try {
        const response = await fetch('https://api.resend.com/emails', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                from,
                to: [
                    to
                ],
                subject,
                html,
                text
            })
        });
        const data = await response.json();
        if (!response.ok) {
            throw new Error(data.message || 'Erro no Resend');
        }
        return {
            success: true,
            messageId: data.id
        };
    } catch (error) {
        return {
            success: false,
            error: error.message
        };
    }
}
// Fun√ß√£o para envio via SendGrid
async function sendWithSendGrid(apiKey, from, to, subject, html, text) {
    try {
        const response = await fetch('https://api.sendgrid.com/v3/mail/send', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                personalizations: [
                    {
                        to: [
                            {
                                email: to
                            }
                        ]
                    }
                ],
                from: {
                    email: from
                },
                subject,
                content: [
                    ...text ? [
                        {
                            type: 'text/plain',
                            value: text
                        }
                    ] : [],
                    ...html ? [
                        {
                            type: 'text/html',
                            value: html
                        }
                    ] : []
                ]
            })
        });
        if (!response.ok) {
            const error = await response.text();
            throw new Error(error || 'Erro no SendGrid');
        }
        return {
            success: true,
            messageId: response.headers.get('x-message-id') || `sg_${Date.now()}`
        };
    } catch (error) {
        return {
            success: false,
            error: error.message
        };
    }
}
// Fun√ß√£o para envio via Mailgun
async function sendWithMailgun(apiKey, from, to, subject, html, text) {
    try {
        const domain = from.split('@')[1] // Extrair dom√≠nio do email
        ;
        const response = await fetch(`https://api.mailgun.net/v3/${domain}/messages`, {
            method: 'POST',
            headers: {
                'Authorization': `Basic ${Buffer.from(`api:${apiKey}`).toString('base64')}`,
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({
                from,
                to,
                subject,
                ...text && {
                    text
                },
                ...html && {
                    html
                }
            })
        });
        const data = await response.json();
        if (!response.ok) {
            throw new Error(data.message || 'Erro no Mailgun');
        }
        return {
            success: true,
            messageId: data.id
        };
    } catch (error) {
        return {
            success: false,
            error: error.message
        };
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__47ce068a._.js.map