module.exports=[35570,a=>{"use strict";var b=a.i(92552),c=a.i(63206),d=a.i(88045),e=a.i(55875),f=a.i(17601),g=a.i(3093),h=a.i(4234),i=a.i(52240),j=a.i(63535);let k=(0,j.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var l=a.i(53206),m=a.i(93090),n=a.i(85632);let o=(0,j.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var p=a.i(50143),q=a.i(14174);function r(){let[a,j]=(0,c.useState)(null),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)({}),F=(0,e.useRouter)();(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await d.supabase.auth.getUser();a?(j(a),H(a.id),G()):F.push("/login")})()},[F]);let G=async()=>{let{data:a}=await d.supabase.from("settings").select("primary_color").limit(1);a&&a.length>0&&w(a[0])},H=async a=>{u(!0);try{let{data:b,error:c}=await d.supabase.from("orders").select(`
          *,
          clients (name, email, phone),
          order_items (
            quantity,
            unit_price,
            total_price,
            products (name, brand)
          )
        `).eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;s(b||[])}catch(a){console.error("Erro ao carregar pedidos:",a)}finally{u(!1)}},I=r.filter(a=>{let b=""===x||a.id.toLowerCase().includes(x.toLowerCase())||a.clients?.name?.toLowerCase().includes(x.toLowerCase())||a.order_items?.some(a=>a.products?.name?.toLowerCase().includes(x.toLowerCase())),c=""===z||a.status===z;return b&&c}),J=async()=>{if(B&&a)try{let{error:b}=await d.supabase.from("orders").update({status:D.status,tracking_code:D.tracking_code,estimated_delivery:D.estimated_delivery,notes:D.notes,updated_at:new Date().toISOString()}).eq("id",B).eq("user_id",a.id);if(b)throw b;if(H(a.id),C(null),E({}),"Enviado"===D.status||"Entregue"===D.status)try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.id,title:"Pedido Atualizado",message:`Status do pedido #${B.slice(-8).toUpperCase()} alterado para ${D.status}`,type:"info",data:{orderId:B,newStatus:D.status,trackingCode:D.tracking_code}})})}catch(a){console.error("Erro ao criar notificação:",a)}}catch(a){console.error("Erro ao atualizar pedido:",a),alert("Erro ao atualizar pedido")}},K=()=>{C(null),E({})};return t?(0,b.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando pedidos..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,b.jsx)("header",{className:"bg-white shadow",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("button",{onClick:()=>F.push("/dashboard"),className:"flex items-center text-gray-600 hover:text-gray-900",children:[(0,b.jsx)(f.ArrowLeft,{className:"h-5 w-5 mr-2"}),"Voltar ao Dashboard"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Pedidos"}),(0,b.jsxs)("p",{className:"text-gray-600",children:[I.length," pedidos encontrados"]})]})]})})})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Search,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"ID do pedido, cliente ou produto...",value:x,onChange:a=>y(a.target.value),className:"pl-10 w-full border border-gray-300 rounded px-3 py-2"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(n.Filter,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),(0,b.jsxs)("select",{value:z,onChange:a=>A(a.target.value),className:"pl-10 w-full border border-gray-300 rounded px-3 py-2",children:[(0,b.jsx)("option",{value:"",children:"Todos os status"}),(0,b.jsx)("option",{value:"Pendente",children:"Pendente"}),(0,b.jsx)("option",{value:"Confirmado",children:"Confirmado"}),(0,b.jsx)("option",{value:"Em Preparação",children:"Em Preparação"}),(0,b.jsx)("option",{value:"Enviado",children:"Enviado"}),(0,b.jsx)("option",{value:"Entregue",children:"Entregue"}),(0,b.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)("button",{onClick:()=>{y(""),A("")},className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded hover:bg-gray-200",children:"Limpar Filtros"})})]})}),(0,b.jsx)("div",{className:"space-y-4",children:I.map(a=>(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(a=>{switch(a){case"Pendente":return(0,b.jsx)(k,{className:"h-4 w-4 text-yellow-500"});case"Confirmado":return(0,b.jsx)(l.AlertCircle,{className:"h-4 w-4 text-blue-500"});case"Em Preparação":return(0,b.jsx)(g.Package,{className:"h-4 w-4 text-orange-500"});case"Enviado":return(0,b.jsx)(h.Truck,{className:"h-4 w-4 text-purple-500"});case"Entregue":return(0,b.jsx)(i.CheckCircle,{className:"h-4 w-4 text-green-500"});case"Cancelado":return(0,b.jsx)(q.X,{className:"h-4 w-4 text-red-500"});default:return(0,b.jsx)(k,{className:"h-4 w-4 text-gray-500"})}})(a.status),(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(a=>{switch(a){case"Pendente":return"bg-yellow-100 text-yellow-800";case"Confirmado":return"bg-blue-100 text-blue-800";case"Em Preparação":return"bg-orange-100 text-orange-800";case"Enviado":return"bg-purple-100 text-purple-800";case"Entregue":return"bg-green-100 text-green-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(a.status)}`,children:a.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Pedido #",a.id.slice(-8).toUpperCase()]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(a.created_at).toLocaleDateString("pt-BR")," às ",new Date(a.created_at).toLocaleTimeString("pt-BR")]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",a.total_value?.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[a.order_items?.length||0," itens"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),(0,b.jsx)("p",{className:"text-sm text-gray-900",children:a.clients?.name||"Cliente não informado"}),a.clients?.email&&(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.clients.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,b.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:"catalog"===a.order_type?"Catálogo":"quick_brand"===a.order_type?"Pedido Rápido":a.order_type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Pagamento"}),(0,b.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:"boleto"===a.payment_method?"Boleto":"pix"===a.payment_method?"PIX":"cartao"===a.payment_method?"Cartão":a.payment_method||"Não informado"})]})]}),a.delivery_address&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Endereço de Entrega"}),(0,b.jsx)("p",{className:"text-sm text-gray-900",children:a.delivery_address})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Itens do Pedido"}),(0,b.jsx)("div",{className:"space-y-2",children:a.order_items?.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{children:[a.products?.name," ",a.products?.brand?`(${a.products.brand})`:""]}),(0,b.jsxs)("span",{children:[a.quantity,"x R$ ",a.unit_price?.toFixed(2)," = R$ ",a.total_price?.toFixed(2)]})]},c))})]}),B===a.id?(0,b.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Editar Pedido"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,b.jsxs)("select",{value:D.status||"",onChange:a=>E(b=>({...b,status:a.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",children:[(0,b.jsx)("option",{value:"Pendente",children:"Pendente"}),(0,b.jsx)("option",{value:"Confirmado",children:"Confirmado"}),(0,b.jsx)("option",{value:"Em Preparação",children:"Em Preparação"}),(0,b.jsx)("option",{value:"Enviado",children:"Enviado"}),(0,b.jsx)("option",{value:"Entregue",children:"Entregue"}),(0,b.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código de Rastreamento"}),(0,b.jsx)("input",{type:"text",value:D.tracking_code||"",onChange:a=>E(b=>({...b,tracking_code:a.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Ex: BR123456789BR"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Estimada de Entrega"}),(0,b.jsx)("input",{type:"date",value:D.estimated_delivery||"",onChange:a=>E(b=>({...b,estimated_delivery:a.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),(0,b.jsx)("textarea",{value:D.notes||"",onChange:a=>E(b=>({...b,notes:a.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 h-20",placeholder:"Observações sobre o pedido..."})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,b.jsx)("button",{onClick:K,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Cancelar"}),(0,b.jsxs)("button",{onClick:J,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",style:{backgroundColor:v?.primary_color||"#3B82F6"},children:[(0,b.jsx)(p.Save,{className:"h-4 w-4 mr-1 inline"}),"Salvar"]})]})]}):(0,b.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[a.tracking_code&&(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Rastreamento:"})," ",a.tracking_code]}),a.estimated_delivery&&(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Entrega Estimada:"})," ",new Date(a.estimated_delivery).toLocaleDateString("pt-BR")]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Observações:"})," ",a.notes]})]}),(0,b.jsxs)("button",{onClick:()=>{C(a.id),E({status:a.status,tracking_code:a.tracking_code||"",estimated_delivery:a.estimated_delivery||"",notes:a.notes||""})},className:"flex items-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100",children:[(0,b.jsx)(o,{className:"h-4 w-4 mr-1"}),"Editar"]})]})})]},a.id))}),0===I.length&&(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(g.Package,{className:"h-24 w-24 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Nenhum pedido encontrado"}),(0,b.jsx)("p",{className:"text-gray-600",children:0===r.length?"Você ainda não tem pedidos.":"Tente ajustar os filtros de busca."})]})]})]})}a.s(["default",()=>r],35570)}];

//# sourceMappingURL=src_app_dashboard_orders_page_tsx_2b23172a._.js.map