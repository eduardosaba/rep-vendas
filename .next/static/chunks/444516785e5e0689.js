(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42500,e=>{"use strict";let a=(0,e.i(22436).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);e.s(["ShoppingCart",()=>a],42500)},35993,(e,a,t)=>{a.exports=e.r(38563)},53938,e=>{"use strict";let a=(0,e.i(22436).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],53938)},69439,e=>{"use strict";var a=e.i(65717),t=e.i(17614),s=e.i(84515),r=e.i(35993),d=e.i(22436);let l=(0,d.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var i=e.i(53938),o=e.i(48885);let n=(0,d.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),c=(0,d.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var m=e.i(42500);function x(){let[e,d]=(0,t.useState)({}),[x,p]=(0,t.useState)([]),[u,h]=(0,t.useState)(null),[g,y]=(0,t.useState)([]),[b,f]=(0,t.useState)(""),[j,v]=(0,t.useState)(!0),[N,_]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),$=(0,r.useRouter)(),[k,P]=(0,t.useState)({client_name:"",client_email:"",client_phone:"",delivery_address:"",payment_method:"boleto",notes:""});(0,t.useEffect)(()=>{S(),R(),E()},[]),(0,t.useEffect)(()=>{Object.keys(e).length>0?F():(p([]),v(!1))},[e]);let S=()=>{let e=localStorage.getItem("cart");e?d(JSON.parse(e)):v(!1)},F=async()=>{let a=Object.keys(e),{data:t}=await s.supabase.from("products").select("*").in("id",a);t&&p(t.map(a=>({product:a,quantity:e[a.id]||0}))),v(!1)},R=async()=>{let{data:e}=await s.supabase.from("settings").select("*").limit(1);e&&e.length>0&&h(e[0])},E=async()=>{let{data:{user:e}}=await s.supabase.auth.getUser();if(e){let{data:a}=await s.supabase.from("clients").select("*").eq("user_id",e.id).order("name");y(a||[])}},q=()=>x.reduce((e,a)=>e+a.product.price*a.quantity,0),O=()=>Object.values(e).reduce((e,a)=>e+a,0),T=async e=>{e.preventDefault(),_(!0);try{let{data:{user:e}}=await s.supabase.auth.getUser();if(!e)return void alert("Usuário não autenticado");let a={user_id:e.id,client_id:b||null,status:"Pendente",total_value:q(),order_type:"catalog",delivery_address:k.delivery_address,payment_method:k.payment_method,notes:k.notes,order_items:x.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.product.price,total_price:e.product.price*e.quantity}))},{data:t,error:r}=await s.supabase.from("orders").insert({user_id:a.user_id,client_id:a.client_id,status:a.status,total_value:a.total_value,order_type:a.order_type,delivery_address:a.delivery_address,payment_method:a.payment_method,notes:a.notes}).select().single();if(r)throw r;let d=a.order_items.map(e=>({order_id:t.id,...e})),{error:l}=await s.supabase.from("order_items").insert(d);if(l)throw l;try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,title:"Novo Pedido Recebido",message:`Pedido #${t.id.slice(-8).toUpperCase()} foi criado com sucesso. Valor: R$ ${q().toFixed(2)}`,type:"success",data:{orderId:t.id,orderNumber:t.id.slice(-8).toUpperCase(),totalValue:q(),clientName:k.client_name}})})}catch(e){console.error("Erro ao criar notificação:",e)}if(k.client_email)try{let a=`
            <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
              <h1 style="color: #333; text-align: center;">Pedido Recebido!</h1>
              <p>Ol\xe1 ${k.client_name},</p>
              <p>Seu pedido foi recebido com sucesso e est\xe1 sendo processado.</p>

              <div style="background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px;">
                <h3>Detalhes do Pedido:</h3>
                <p><strong>N\xfamero do Pedido:</strong> #${t.id.slice(-8).toUpperCase()}</p>
                <p><strong>Data:</strong> ${new Date().toLocaleDateString("pt-BR")}</p>
                <p><strong>Valor Total:</strong> R$ ${q().toFixed(2)}</p>
                <p><strong>Forma de Pagamento:</strong> ${"boleto"===k.payment_method?"Boleto Bancário":"pix"===k.payment_method?"PIX":"Cartão de Crédito"}</p>
              </div>

              <div style="background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px;">
                <h3>Itens do Pedido:</h3>
                ${x.map(e=>`
                  <div style="border-bottom: 1px solid #dee2e6; padding: 10px 0;">
                    <p><strong>${e.product.name}</strong></p>
                    <p>Quantidade: ${e.quantity} | Pre\xe7o: R$ ${e.product.price.toFixed(2)} | Total: R$ ${(e.product.price*e.quantity).toFixed(2)}</p>
                  </div>
                `).join("")}
              </div>

              <div style="background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px;">
                <h3>Endere\xe7o de Entrega:</h3>
                <p>${k.delivery_address}</p>
              </div>

              ${k.notes?`
                <div style="background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px;">
                  <h3>Observa\xe7\xf5es:</h3>
                  <p>${k.notes}</p>
                </div>
              `:""}

              <p>Em breve entraremos em contato para confirmar os detalhes do pedido.</p>
              <p>Atenciosamente,<br>Equipe Rep-Vendas</p>
            </div>
          `,s=`
            Pedido Recebido!

            Ol\xe1 ${k.client_name},

            Seu pedido foi recebido com sucesso e est\xe1 sendo processado.

            Detalhes do Pedido:
            N\xfamero do Pedido: #${t.id.slice(-8).toUpperCase()}
            Data: ${new Date().toLocaleDateString("pt-BR")}
            Valor Total: R$ ${q().toFixed(2)}
            Forma de Pagamento: ${"boleto"===k.payment_method?"Boleto Bancário":"pix"===k.payment_method?"PIX":"Cartão de Crédito"}

            Itens do Pedido:
            ${x.map(e=>`- ${e.product.name} (Qtd: ${e.quantity}) - R$ ${(e.product.price*e.quantity).toFixed(2)}`).join("\n")}

            Endere\xe7o de Entrega:
            ${k.delivery_address}

            ${k.notes?`Observa\xe7\xf5es: ${k.notes}`:""}

            Em breve entraremos em contato para confirmar os detalhes do pedido.

            Atenciosamente,
            Equipe Rep-Vendas
          `;await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:k.client_email,subject:`Pedido #${t.id.slice(-8).toUpperCase()} - Rep-Vendas`,html:a,text:s,userId:e.id})})}catch(e){console.error("Erro ao enviar email:",e)}localStorage.removeItem("cart"),C(!0)}catch(e){console.error("Erro ao finalizar pedido:",e),alert("Erro ao finalizar pedido. Tente novamente.")}finally{_(!1)}};return j?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando checkout..."})]})}):0!==x.length||w?w?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,a.jsx)(o.CheckCircle,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pedido Finalizado!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Seu pedido foi criado com sucesso e está sendo processado."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:()=>$.push("/dashboard"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors",style:{backgroundColor:u?.primary_color||"#3B82F6"},children:"Ver Meus Pedidos"}),(0,a.jsx)("button",{onClick:()=>$.push("/"),className:"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:"Continuar Comprando"})]})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",style:{backgroundColor:u?.header_color||"#FFFFFF"},children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex items-center justify-between py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsxs)("button",{onClick:()=>$.back(),className:"flex items-center text-gray-600 hover:text-gray-900",style:{color:u?.icon_color||"#4B5563"},children:[(0,a.jsx)(i.ArrowLeft,{className:"h-5 w-5 mr-2"}),"Voltar"]}),u?.logo_url?(0,a.jsx)("img",{src:u.logo_url,alt:"Logo",className:"h-14 w-auto"}):(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",style:{color:u?.title_color||"#111827",fontFamily:u?.font_family||"Inter, sans-serif"},children:"Rep-Vendas"})]})})})}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Finalizar Pedido"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[O()," produto",O()>1?"s":""," • Total: R$ ",q().toFixed(2)]})]}),(0,a.jsxs)("form",{onSubmit:T,className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(c,{className:"h-5 w-5 mr-2"}),"Dados do Cliente"]}),g.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecionar cliente existente"}),(0,a.jsxs)("select",{value:b,onChange:e=>{var a;let t;return f(a=e.target.value),void((t=g.find(e=>e.id===a))&&P(e=>({...e,client_name:t.name,client_email:t.email||"",client_phone:t.phone||"",delivery_address:t.address||""})))},className:"w-full border border-gray-300 rounded px-3 py-2",children:[(0,a.jsx)("option",{value:"",children:"Novo cliente"}),g.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),(0,a.jsx)("input",{type:"text",required:!0,value:k.client_name,onChange:e=>P(a=>({...a,client_name:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Nome completo"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",value:k.client_email,onChange:e=>P(a=>({...a,client_email:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"email@exemplo.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),(0,a.jsx)("input",{type:"tel",value:k.client_phone,onChange:e=>P(a=>({...a,client_phone:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"(11) 99999-9999"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(n,{className:"h-5 w-5 mr-2"}),"Endereço de Entrega"]}),(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{required:!0,value:k.delivery_address,onChange:e=>P(a=>({...a,delivery_address:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 h-24",placeholder:"Endereço completo para entrega"})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(l,{className:"h-5 w-5 mr-2"}),"Forma de Pagamento"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"boleto",checked:"boleto"===k.payment_method,onChange:e=>P(a=>({...a,payment_method:e.target.value})),className:"mr-2"}),"Boleto Bancário"]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"pix",checked:"pix"===k.payment_method,onChange:e=>P(a=>({...a,payment_method:e.target.value})),className:"mr-2"}),"PIX"]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"cartao",checked:"cartao"===k.payment_method,onChange:e=>P(a=>({...a,payment_method:e.target.value})),className:"mr-2"}),"Cartão de Crédito"]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Observações"}),(0,a.jsx)("textarea",{value:k.notes,onChange:e=>P(a=>({...a,notes:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 h-24",placeholder:"Observações adicionais sobre o pedido"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Itens do Pedido"}),(0,a.jsx)("div",{className:"space-y-4",children:x.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 flex-shrink-0",children:e.product.image_url?(0,a.jsx)("img",{src:e.product.image_url,alt:e.product.name,className:"w-full h-full object-cover rounded"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-100 rounded flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"Sem imagem"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e.product.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.product.brand||"Marca"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Qtd: ",e.quantity]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["R$ ",(e.product.price*e.quantity).toFixed(2)]})})]},e.product.id))})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Resumo do Pedido"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:["Subtotal (",O()," itens)"]}),(0,a.jsxs)("span",{className:"text-gray-900",children:["R$ ",q().toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Frete"}),(0,a.jsx)("span",{className:"text-green-600",children:"Grátis"})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,a.jsxs)("div",{className:"flex justify-between text-lg font-medium",children:[(0,a.jsx)("span",{className:"text-gray-900",children:"Total"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["R$ ",q().toFixed(2)]})]})})]}),(0,a.jsx)("button",{type:"submit",disabled:N,className:"w-full mt-6 bg-blue-600 text-white py-3 px-4 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:u?.primary_color||"#3B82F6"},children:N?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processando..."]}):"Finalizar Pedido"})]})]})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(m.ShoppingCart,{className:"h-24 w-24 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Carrinho vazio"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Adicione produtos ao carrinho antes de finalizar o pedido."}),(0,a.jsx)("button",{onClick:()=>$.push("/"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",style:{backgroundColor:u?.primary_color||"#3B82F6"},children:"Voltar ao Catálogo"})]})})})}e.s(["default",()=>x],69439)}]);