(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,35993,(e,t,a)=>{t.exports=e.r(38563)},53938,e=>{"use strict";let t=(0,e.i(22436).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],53938)},84762,e=>{"use strict";let t=(0,e.i(22436).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],84762)},93183,e=>{"use strict";let t=(0,e.i(22436).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],93183)},82267,e=>{"use strict";let t=(0,e.i(22436).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],82267)},329,73528,e=>{"use strict";var t=e.i(22436);let a=(0,t.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],329);let s=(0,t.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>s],73528)},68659,e=>{"use strict";var t=e.i(65717),a=e.i(17614),s=e.i(84515),r=e.i(35993),l=e.i(53938),d=e.i(93183),i=e.i(84762),n=e.i(48885),c=e.i(22436);let o=(0,c.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var m=e.i(94176),x=e.i(329),u=e.i(73528);let h=(0,c.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var p=e.i(82267),g=e.i(44021);function y(){let[e,c]=(0,a.useState)(null),[y,j]=(0,a.useState)([]),[b,v]=(0,a.useState)(!0),[f,N]=(0,a.useState)({}),[w,k]=(0,a.useState)(""),[C,_]=(0,a.useState)(""),[E,P]=(0,a.useState)(null),[S,R]=(0,a.useState)({}),L=(0,r.useRouter)();(0,a.useEffect)(()=>{(async()=>{let{data:{user:e}}=await s.supabase.auth.getUser();e?(c(e),A(e.id),M()):L.push("/login")})()},[L]);let M=async()=>{let{data:e}=await s.supabase.from("settings").select("primary_color").limit(1);e&&e.length>0&&N(e[0])},A=async e=>{v(!0);try{let{data:t,error:a}=await s.supabase.from("orders").select(`
          *,
          clients (name, email, phone),
          order_items (
            quantity,
            unit_price,
            total_price,
            products (name, brand)
          )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(a)throw a;j(t||[])}catch(e){console.error("Erro ao carregar pedidos:",e)}finally{v(!1)}},T=y.filter(e=>{let t=""===w||e.id.toLowerCase().includes(w.toLowerCase())||e.clients?.name?.toLowerCase().includes(w.toLowerCase())||e.order_items?.some(e=>e.products?.name?.toLowerCase().includes(w.toLowerCase())),a=""===C||e.status===C;return t&&a}),q=async()=>{if(E&&e)try{let{error:t}=await s.supabase.from("orders").update({status:S.status,tracking_code:S.tracking_code,estimated_delivery:S.estimated_delivery,notes:S.notes,updated_at:new Date().toISOString()}).eq("id",E).eq("user_id",e.id);if(t)throw t;if(A(e.id),P(null),R({}),"Enviado"===S.status||"Entregue"===S.status)try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,title:"Pedido Atualizado",message:`Status do pedido #${E.slice(-8).toUpperCase()} alterado para ${S.status}`,type:"info",data:{orderId:E,newStatus:S.status,trackingCode:S.tracking_code}})})}catch(e){console.error("Erro ao criar notificação:",e)}}catch(e){console.error("Erro ao atualizar pedido:",e),alert("Erro ao atualizar pedido")}},z=()=>{P(null),R({})};return b?(0,t.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando pedidos..."})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("button",{onClick:()=>L.push("/dashboard"),className:"flex items-center text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(l.ArrowLeft,{className:"h-5 w-5 mr-2"}),"Voltar ao Dashboard"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Pedidos"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[T.length," pedidos encontrados"]})]})]})})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.Search,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"ID do pedido, cliente ou produto...",value:w,onChange:e=>k(e.target.value),className:"pl-10 w-full border border-gray-300 rounded px-3 py-2"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(u.Filter,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),(0,t.jsxs)("select",{value:C,onChange:e=>_(e.target.value),className:"pl-10 w-full border border-gray-300 rounded px-3 py-2",children:[(0,t.jsx)("option",{value:"",children:"Todos os status"}),(0,t.jsx)("option",{value:"Pendente",children:"Pendente"}),(0,t.jsx)("option",{value:"Confirmado",children:"Confirmado"}),(0,t.jsx)("option",{value:"Em Preparação",children:"Em Preparação"}),(0,t.jsx)("option",{value:"Enviado",children:"Enviado"}),(0,t.jsx)("option",{value:"Entregue",children:"Entregue"}),(0,t.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)("button",{onClick:()=>{k(""),_("")},className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded hover:bg-gray-200",children:"Limpar Filtros"})})]})}),(0,t.jsx)("div",{className:"space-y-4",children:T.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"Pendente":return(0,t.jsx)(o,{className:"h-4 w-4 text-yellow-500"});case"Confirmado":return(0,t.jsx)(m.AlertCircle,{className:"h-4 w-4 text-blue-500"});case"Em Preparação":return(0,t.jsx)(d.Package,{className:"h-4 w-4 text-orange-500"});case"Enviado":return(0,t.jsx)(i.Truck,{className:"h-4 w-4 text-purple-500"});case"Entregue":return(0,t.jsx)(n.CheckCircle,{className:"h-4 w-4 text-green-500"});case"Cancelado":return(0,t.jsx)(g.X,{className:"h-4 w-4 text-red-500"});default:return(0,t.jsx)(o,{className:"h-4 w-4 text-gray-500"})}})(e.status),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"Pendente":return"bg-yellow-100 text-yellow-800";case"Confirmado":return"bg-blue-100 text-blue-800";case"Em Preparação":return"bg-orange-100 text-orange-800";case"Enviado":return"bg-purple-100 text-purple-800";case"Entregue":return"bg-green-100 text-green-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:e.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Pedido #",e.id.slice(-8).toUpperCase()]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(e.created_at).toLocaleDateString("pt-BR")," às ",new Date(e.created_at).toLocaleTimeString("pt-BR")]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",e.total_value?.toFixed(2)]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e.order_items?.length||0," itens"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),(0,t.jsx)("p",{className:"text-sm text-gray-900",children:e.clients?.name||"Cliente não informado"}),e.clients?.email&&(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.clients.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,t.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:"catalog"===e.order_type?"Catálogo":"quick_brand"===e.order_type?"Pedido Rápido":e.order_type})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Pagamento"}),(0,t.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:"boleto"===e.payment_method?"Boleto":"pix"===e.payment_method?"PIX":"cartao"===e.payment_method?"Cartão":e.payment_method||"Não informado"})]})]}),e.delivery_address&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Endereço de Entrega"}),(0,t.jsx)("p",{className:"text-sm text-gray-900",children:e.delivery_address})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Itens do Pedido"}),(0,t.jsx)("div",{className:"space-y-2",children:e.order_items?.map((e,a)=>(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{children:[e.products?.name," ",e.products?.brand?`(${e.products.brand})`:""]}),(0,t.jsxs)("span",{children:[e.quantity,"x R$ ",e.unit_price?.toFixed(2)," = R$ ",e.total_price?.toFixed(2)]})]},a))})]}),E===e.id?(0,t.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Editar Pedido"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,t.jsxs)("select",{value:S.status||"",onChange:e=>R(t=>({...t,status:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",children:[(0,t.jsx)("option",{value:"Pendente",children:"Pendente"}),(0,t.jsx)("option",{value:"Confirmado",children:"Confirmado"}),(0,t.jsx)("option",{value:"Em Preparação",children:"Em Preparação"}),(0,t.jsx)("option",{value:"Enviado",children:"Enviado"}),(0,t.jsx)("option",{value:"Entregue",children:"Entregue"}),(0,t.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código de Rastreamento"}),(0,t.jsx)("input",{type:"text",value:S.tracking_code||"",onChange:e=>R(t=>({...t,tracking_code:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Ex: BR123456789BR"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Estimada de Entrega"}),(0,t.jsx)("input",{type:"date",value:S.estimated_delivery||"",onChange:e=>R(t=>({...t,estimated_delivery:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),(0,t.jsx)("textarea",{value:S.notes||"",onChange:e=>R(t=>({...t,notes:e.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 h-20",placeholder:"Observações sobre o pedido..."})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,t.jsx)("button",{onClick:z,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Cancelar"}),(0,t.jsxs)("button",{onClick:q,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",style:{backgroundColor:f?.primary_color||"#3B82F6"},children:[(0,t.jsx)(p.Save,{className:"h-4 w-4 mr-1 inline"}),"Salvar"]})]})]}):(0,t.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[e.tracking_code&&(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Rastreamento:"})," ",e.tracking_code]}),e.estimated_delivery&&(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Entrega Estimada:"})," ",new Date(e.estimated_delivery).toLocaleDateString("pt-BR")]}),e.notes&&(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Observações:"})," ",e.notes]})]}),(0,t.jsxs)("button",{onClick:()=>{P(e.id),R({status:e.status,tracking_code:e.tracking_code||"",estimated_delivery:e.estimated_delivery||"",notes:e.notes||""})},className:"flex items-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100",children:[(0,t.jsx)(h,{className:"h-4 w-4 mr-1"}),"Editar"]})]})})]},e.id))}),0===T.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(d.Package,{className:"h-24 w-24 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Nenhum pedido encontrado"}),(0,t.jsx)("p",{className:"text-gray-600",children:0===y.length?"Você ainda não tem pedidos.":"Tente ajustar os filtros de busca."})]})]})]})}e.s(["default",()=>y],68659)}]);